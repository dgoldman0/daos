<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reward Pool NFT Interface</title>
  <!-- Google Fonts for better typography -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&display=swap" rel="stylesheet">
  <!-- Include Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <style>
    /* Reset some default browser styles */
    * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    }

    /* Body styling */
    body {
    font-family: 'Press Start 2P', sans-serif; /* Futuristic gamer font */
    background-color: #1a1a1a;
    color: #e2e2e2;
    line-height: 1.6;
    letter-spacing: 0.05em;
    overflow-x: hidden;
    }

    /* Header styling */
    header {
    background-color: #141414;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #ffffff;
    border-bottom: 2px solid #3a3a3a;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    header h1 {
    font-size: 22px;
    text-transform: uppercase;
    color: #f5f5f5;
    letter-spacing: 0.1em;
    text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff;
    }

    .connect-wallet {
    padding: 12px 25px;
    background-color: #00ffff;
    color: #1a1a1a;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.3s, box-shadow 0.3s;
    text-transform: uppercase;
    font-size: 14px;
    letter-spacing: 0.1em;
    box-shadow: 0 0 15px #00ffff;
    }

    .connect-wallet:hover {
    background-color: #1a1a1a;
    color: #00ffff;
    box-shadow: 0 0 20px #00ffff, 0 0 40px #00ffff;
    }

    /* Container styling */
    .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;
    }

    /* Section styling */
    .section h2 {
    margin-top: 100px;
    margin-bottom: 20px;
    font-size: 24px;
    color: #ffffff;
    border-bottom: 3px solid #00ffff;
    padding-bottom: 10px;
    text-transform: uppercase;
    text-shadow: 0 0 10px #ff00ff;
    letter-spacing: 0.1em;
    }

    /* NFT Grid styling */
    .nft-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
    }

    /* NFT Card styling */
    .nft-card {
    background-color: #262626;
    padding: 20px;
    border-radius: 10px;
    border: 2px solid #3a3a3a;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6);
    transition: transform 0.2s, border 0.2s, box-shadow 0.2s;
    position: relative;
    }

    .nft-card:hover {
    transform: translateY(-5px);
    border: 2px solid #00ffff;
    box-shadow: 0 4px 30px #00ffff, 0 0 40px #ff00ff;
    }

    .nft-card h3 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 20px;
    color: #ffffff;
    text-shadow: 0 0 5px #ff00ff;
    }

    .nft-card .nft-image {
    width: 100%;
    height: 200px;
    background-color: #1a1a1a;
    border-radius: 10px;
    margin-bottom: 15px;
    background-size: cover;
    background-position: center;
    border: 2px solid #3a3a3a;
    }

    /* Health Bar */
    .nft-card .health-bar {
    background-color: #3a3a3a;
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 10px;
    }

    .nft-card .health-bar div {
    height: 10px;
    background-color: #00ff00;
    transition: width 0.3s;
    }

    .nft-card .action-buttons {
    display: flex;
    justify-content: flex-start;
    margin-top: 15px;
    }

    /* Button styling */
    .button {
    padding: 10px 15px;
    background-color: #00ffff;
    color: #1a1a1a;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-right: 10px;
    font-weight: 500;
    font-size: 12px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    box-shadow: 0 0 10px #00ffff;
    transition: background-color 0.3s, box-shadow 0.3s, transform 0.2s;
    }

    .button:hover {
    background-color: #141414;
    color: #00ffff;
    box-shadow: 0 0 20px #00ffff, 0 0 40px #ff00ff;
    transform: translateY(-2px);
    }

    .button:disabled {
    background-color: #333;
    cursor: not-allowed;
    box-shadow: none;
    }

    /* Info text styling */
    .info {
    margin-bottom: 10px;
    font-size: 16px;
    color: #dcdcdc;
    }

    .info span {
    font-weight: 600;
    color: #00ffff;
    }

    /* Input styling */
    input[type="number"] {
    padding: 10px;
    width: 100px;
    margin-right: 10px;
    border: 2px solid #3a3a3a;
    border-radius: 5px;
    background-color: #1a1a1a;
    color: #ffffff;
    font-size: 16px;
    }

    input[type="number"]:focus {
    outline: none;
    border-color: #00ffff;
    box-shadow: 0 0 10px #00ffff;
    }

    /* Footer styling */
    footer {
    background-color: #141414;
    padding: 20px;
    text-align: center;
    color: #ffffff;
    border-top: 2px solid #3a3a3a;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.5);
    }

    footer p {
    margin: 0;
    color: #00ffff;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 12px;
    }

    /* Notification area */
    #notificationArea {
    position: fixed;
    top: 80px;
    right: 20px;
    width: 300px;
    z-index: 1000;
    }

    .notification {
    background-color: #00ffff;
    color: #1a1a1a;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 5px;
    animation: fadeOut 4s forwards;
    box-shadow: 0 0 20px #00ffff, 0 0 40px #ff00ff;
    }

    .error-notification {
    background-color: #ff0055;
    box-shadow: 0 0 20px #ff0055, 0 0 40px #ff00ff;
    }

    /* Fade out animation */
    @keyframes fadeOut {
    0% { opacity: 1; }
    75% { opacity: 1; }
    100% { opacity: 0; display: none; }
    }

    /* Responsive design */
    @media (max-width: 768px) {
    .container {
        padding: 20px;
    }

    header h1 {
        font-size: 20px;
    }

    .connect-wallet {
        padding: 8px 16px;
        font-size: 14px;
    }

    .section h2 {
        font-size: 22px;
    }

    .nft-card h3 {
        font-size: 18px;
    }

    .button {
        padding: 8px 12px;
        font-size: 14px;
    }

    input[type="number"] {
        width: 80px;
        font-size: 14px;
    }
	}
	.top-menu {
		display: flex;
		justify-content: flex-start;
		align-items: center;
		padding: 10px 20px;
		background-color: #141414;
		border-bottom: 2px solid #3a3a3a;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
	}

	.menu-item {
		padding: 10px 20px;
		color: #ffffff;
		cursor: pointer;
		font-weight: 500;
		font-size: 14px;
		letter-spacing: 0.1em;
		text-transform: uppercase;
	}
	.menu-item:hover {
		color: #167fa6;
	}
  </style>
</head>
<body>
  <header>
    <h1><i class="fas fa-gem"></i> Reward Pool NFT Interface</h1>
    <button id="connectWalletButton" class="connect-wallet">Connect Wallet</button>
  </header>
  <div class = "top-menu">
	<a class = "menu-item" href="/">Reward Pool</a>
	<a class = "menu-item" href="/lotto">Lotto</a>
	<a class = "menu-item" href="/games/mancala">Mancala</a>
  </div>
  <!-- Notification Area -->
  <div id="notificationArea"></div>

  <div class="container">
    <!-- My NFTs Section -->
    <div class="section" id="myNftsSection">
      <h2>My NFTs</h2>
      <div id="nftGrid" class="nft-grid"></div>
    </div>

	<!-- Mint NFTs Section -->
	<div class="section" id="mintSection">
	  <h2>Mint NFTs</h2>
	  <div class="info">Mint Price: <span id="mintPrice"></span></div>
	  <!-- Need to adjust max amount to whatever the contract max amount is I suppose-->
	  <input type="number" id="mintAmt" placeholder="Amount" min="1" max="100">
	  <button id="mintButton" class="button">Mint NFT</button>
	</div>

    <!-- Buy Repair Potions Section -->
	<!-- Should have an easy way for repair multiple, but I can't figure out UI for that yet...-->
    <div class="section" id="potionSection">
      <h2>Buy Repair Potions</h2>
      <div class="info">Potion Price: <span id="potionPrice"></span></div>
      <div class="info">Your Potion Balance: <span id="potionBalance"></span></div>
      <div class="purchase-form">
        <input type="number" id="potionAmount" placeholder="Amount" min="1" max="100">
        <button id="buyPotionButton" class="button">Buy Potions</button>
      </div>
    </div>

    <!-- Claim Period Info Section -->
    <div class="section" id="claimPeriodSection">
      <h2>Claim Period Info</h2>
      <div class="info">Time Remaining: <span id="timeRemaining"></span></div>
      <div class="info">Claimants: <span id="claimantsCount"></span>/<span id="claimerLimit"></span></div>
    </div>

    <!-- System Information Section -->
    <div class="section" id="systemInfoSection">
      <h2>System Information</h2>
      <div class="info">Regular Reward Rate: <span id="rewardRate"></span></div>
      <div class="info">Special Reward Rate: <span id="specialRewardRate"></span></div>
      <div class="info">Minimum Claims Required: <span id="minClaims"></span></div>
      <div class="info">Total NFTs Minted: <span id="totalNfts"></span></div>
    </div>
    <div class="section" id="contractAddresses">
      <h2>Contract Addresses:</h2>
      <ul>
        <li>NFT Contract: <a href="#" id="nftContractAddress" target="_blank"></a></li>
        <li>Claim Manager: <a href="#" id="claimManagerAddress" target="_blank"></a></li>
        <li>Payment Manager: <a href="#" id="paymentManagerAddress" target="_blank"></a></li>
        <li>Repair Potion: <a href="#" id="potionContractAddress" target="_blank"></a></li>
      </ul>
    </div>
  </div>

  <footer>
    <p>&copy; 2024 Reward Pool NFT Interface</p>
  </footer>

  <!-- Include web3.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/4.12.1/web3.min.js"></script>

  <script>
    // Contract ABIs (replace with actual ABIs)
    const nftAbi = [
			{
				"inputs": [],
				"stateMutability": "nonpayable",
				"type": "constructor"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "approved",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "Approval",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "operator",
						"type": "address"
					},
					{
						"indexed": false,
						"internalType": "bool",
						"name": "approved",
						"type": "bool"
					}
				],
				"name": "ApprovalForAll",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "minter",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "NFTMinted",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "cancelledBy",
						"type": "address"
					}
				],
				"name": "NominationCancelled",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnerNominated",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "previousOwner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnershipTransferred",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "Transfer",
				"type": "event"
			},
			{
				"inputs": [],
				"name": "acceptOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "approve",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "owner",
						"type": "address"
					}
				],
				"name": "balanceOf",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "cancelTransfer",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "changeOwner",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "claimManager",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "firstMintDate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "fundReceiver",
				"outputs": [
					{
						"internalType": "address payable",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "getApproved",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "operator",
						"type": "address"
					}
				],
				"name": "isApprovedForAll",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "maxSupply",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_count",
						"type": "uint256"
					}
				],
				"name": "mint",
				"outputs": [],
				"stateMutability": "payable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "mintPrice",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "_count",
						"type": "uint256"
					}
				],
				"name": "mintTo",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "name",
				"outputs": [
					{
						"internalType": "string",
						"name": "",
						"type": "string"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "nextTokenId",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "nominationDate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "owner",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "ownerNominee",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "ownerOf",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "paymentToken",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "rejectOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "safeTransferFrom",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					},
					{
						"internalType": "bytes",
						"name": "data",
						"type": "bytes"
					}
				],
				"name": "safeTransferFrom",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "operator",
						"type": "address"
					},
					{
						"internalType": "bool",
						"name": "approved",
						"type": "bool"
					}
				],
				"name": "setApprovalForAll",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "string",
						"name": "baseTokenURI",
						"type": "string"
					}
				],
				"name": "setBaseTokenURI",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_claimManager",
						"type": "address"
					}
				],
				"name": "setClaimManager",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address payable",
						"name": "_fundReceiver",
						"type": "address"
					}
				],
				"name": "setFundReceiver",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_maxSupply",
						"type": "uint256"
					}
				],
				"name": "setMaxSupply",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_paymentToken",
						"type": "address"
					}
				],
				"name": "setPaymentToken",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_price",
						"type": "uint256"
					}
				],
				"name": "setPrice",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "bytes4",
						"name": "interfaceId",
						"type": "bytes4"
					}
				],
				"name": "supportsInterface",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "symbol",
				"outputs": [
					{
						"internalType": "string",
						"name": "",
						"type": "string"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "index",
						"type": "uint256"
					}
				],
				"name": "tokenByIndex",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "index",
						"type": "uint256"
					}
				],
				"name": "tokenOfOwnerByIndex",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "tokenURI",
				"outputs": [
					{
						"internalType": "string",
						"name": "",
						"type": "string"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "totalSupply",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "transferFrom",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_token",
						"type": "address"
					}
				],
				"name": "withdraw",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"stateMutability": "payable",
				"type": "receive"
			}
		];
	const claimManagerAbi = [
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_nftContract",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "_potionToken",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "_paymentManager",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "_claimerLimit",
						"type": "uint256"
					},
					{
						"internalType": "uint256",
						"name": "_claimPeriod",
						"type": "uint256"
					},
					{
						"internalType": "uint8",
						"name": "_min_health",
						"type": "uint8"
					}
				],
				"stateMutability": "nonpayable",
				"type": "constructor"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "claimant",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "Claim",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "cancelledBy",
						"type": "address"
					}
				],
				"name": "NominationCancelled",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnerNominated",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "previousOwner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnershipTransferred",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					},
					{
						"indexed": false,
						"internalType": "uint256",
						"name": "qnt",
						"type": "uint256"
					}
				],
				"name": "TokenRepaired",
				"type": "event"
			},
			{
				"inputs": [],
				"name": "acceptOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "cancelTransfer",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "changeOwner",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "claim",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "claimPeriod",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "index",
						"type": "uint256"
					}
				],
				"name": "claimant",
				"outputs": [
					{
						"components": [
							{
								"internalType": "address",
								"name": "addr",
								"type": "address"
							},
							{
								"internalType": "uint256",
								"name": "tokenId",
								"type": "uint256"
							}
						],
						"internalType": "struct ClaimNFTManager.Claimant",
						"name": "",
						"type": "tuple"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"name": "claimants",
				"outputs": [
					{
						"internalType": "address",
						"name": "addr",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "claimerLimit",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"name": "controllers",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "deleteClaimants",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "getClaimants",
				"outputs": [
					{
						"components": [
							{
								"internalType": "address",
								"name": "addr",
								"type": "address"
							},
							{
								"internalType": "uint256",
								"name": "tokenId",
								"type": "uint256"
							}
						],
						"internalType": "struct ClaimNFTManager.Claimant[]",
						"name": "",
						"type": "tuple[]"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "getClaimantsCount",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "getHealth",
				"outputs": [
					{
						"internalType": "uint8",
						"name": "",
						"type": "uint8"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "getMintDate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "getTotalClaims",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "hasClaimedInPeriod",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "initializeNFT",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "isClaimReady",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "min_health",
				"outputs": [
					{
						"internalType": "uint8",
						"name": "",
						"type": "uint8"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "nftContract",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "nominationDate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "owner",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "ownerNominee",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "paymentManager",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "potionToken",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "rejectOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					},
					{
						"internalType": "uint8",
						"name": "_qnt",
						"type": "uint8"
					}
				],
				"name": "repair",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					}
				],
				"name": "resetClaim",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_claimPeriod",
						"type": "uint256"
					}
				],
				"name": "setClaimPeriod",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_claimerLimit",
						"type": "uint256"
					}
				],
				"name": "setClaimerLimit",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint8",
						"name": "_min_health",
						"type": "uint8"
					}
				],
				"name": "setMinHealth",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_nftContract",
						"type": "address"
					}
				],
				"name": "setNFTContract",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_paymentManager",
						"type": "address"
					}
				],
				"name": "setPaymentManager",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_potionToken",
						"type": "address"
					}
				],
				"name": "setPotionToken",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_token",
						"type": "address"
					}
				],
				"name": "withdraw",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"stateMutability": "payable",
				"type": "receive"
			}
		];
	const paymentManagerAbi = [
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_nftContract",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "_rewardToken",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "_rewardRate",
						"type": "uint256"
					},
					{
						"internalType": "uint256",
						"name": "_specialRewardRate",
						"type": "uint256"
					},
					{
						"internalType": "uint256",
						"name": "_min_claims",
						"type": "uint256"
					}
				],
				"stateMutability": "nonpayable",
				"type": "constructor"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "cancelledBy",
						"type": "address"
					}
				],
				"name": "NominationCancelled",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnerNominated",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "previousOwner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnershipTransferred",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "claimant",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					},
					{
						"indexed": false,
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "RewardDistributed",
				"type": "event"
			},
			{
				"inputs": [],
				"name": "acceptOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "cancelTransfer",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "changeOwner",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "checkAndFinalizePeriod",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "claimManager",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "claimant",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "tokenId",
						"type": "uint256"
					},
					{
						"internalType": "uint256",
						"name": "reward",
						"type": "uint256"
					}
				],
				"name": "distributeReward",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "hasSufficientBalance",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "lastClaimTime",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "min_claims",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "nftContract",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "nominationDate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "owner",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "ownerNominee",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "rejectOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "rewardRate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "rewardToken",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_claimManager",
						"type": "address"
					}
				],
				"name": "setClaimManager",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_min_claims",
						"type": "uint256"
					}
				],
				"name": "setMinClaims",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_nftContract",
						"type": "address"
					}
				],
				"name": "setNFTContract",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_rewardRate",
						"type": "uint256"
					}
				],
				"name": "setRewardRate",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_rewardToken",
						"type": "address"
					}
				],
				"name": "setRewardToken",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_specialRewardRate",
						"type": "uint256"
					}
				],
				"name": "setSpecialRewardRate",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "specialRewardRate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_token",
						"type": "address"
					}
				],
				"name": "withdraw",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"stateMutability": "payable",
				"type": "receive"
			}
		]; 
	const potionAbi = [
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_maxSupply",
						"type": "uint256"
					},
					{
						"internalType": "address",
						"name": "_purchaseToken",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "_purchasePrice",
						"type": "uint256"
					}
				],
				"stateMutability": "nonpayable",
				"type": "constructor"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"indexed": false,
						"internalType": "uint256",
						"name": "value",
						"type": "uint256"
					}
				],
				"name": "Approval",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "cancelledBy",
						"type": "address"
					}
				],
				"name": "NominationCancelled",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnerNominated",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "previousOwner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "OwnershipTransferred",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"indexed": false,
						"internalType": "uint256",
						"name": "value",
						"type": "uint256"
					}
				],
				"name": "Transfer",
				"type": "event"
			},
			{
				"inputs": [],
				"name": "acceptOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					}
				],
				"name": "allowance",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "approve",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "account",
						"type": "address"
					}
				],
				"name": "balanceOf",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "buy",
				"outputs": [],
				"stateMutability": "payable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "cancelTransfer",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "newOwner",
						"type": "address"
					}
				],
				"name": "changeOwner",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_tokenOwner",
						"type": "address"
					}
				],
				"name": "consume",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "decimals",
				"outputs": [
					{
						"internalType": "uint8",
						"name": "",
						"type": "uint8"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "subtractedValue",
						"type": "uint256"
					}
				],
				"name": "decreaseAllowance",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "fundReceiver",
				"outputs": [
					{
						"internalType": "address payable",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "addedValue",
						"type": "uint256"
					}
				],
				"name": "increaseAllowance",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "managerContract",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "maxSupply",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "mint",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "name",
				"outputs": [
					{
						"internalType": "string",
						"name": "",
						"type": "string"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "nominationDate",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "owner",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "ownerNominee",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "purchasePrice",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "purchaseToken",
				"outputs": [
					{
						"internalType": "address",
						"name": "",
						"type": "address"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "rejectOwnership",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address payable",
						"name": "_fundReceiver",
						"type": "address"
					}
				],
				"name": "setFundReceiver",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_managerContract",
						"type": "address"
					}
				],
				"name": "setManagerContract",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_maxSupply",
						"type": "uint256"
					}
				],
				"name": "setMaxSupply",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "uint256",
						"name": "_purchasePrice",
						"type": "uint256"
					}
				],
				"name": "setPurchasePrice",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_purchaseToken",
						"type": "address"
					}
				],
				"name": "setPurchaseToken",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "symbol",
				"outputs": [
					{
						"internalType": "string",
						"name": "",
						"type": "string"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "totalSupply",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "transfer",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "transferFrom",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "_token",
						"type": "address"
					}
				],
				"name": "withdraw",
				"outputs": [],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"stateMutability": "payable",
				"type": "receive"
			}
		];
	const erc20Abi = [
			{
				"inputs": [],
				"stateMutability": "nonpayable",
				"type": "constructor"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"indexed": false,
						"internalType": "uint256",
						"name": "value",
						"type": "uint256"
					}
				],
				"name": "Approval",
				"type": "event"
			},
			{
				"anonymous": false,
				"inputs": [
					{
						"indexed": true,
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"indexed": true,
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"indexed": false,
						"internalType": "uint256",
						"name": "value",
						"type": "uint256"
					}
				],
				"name": "Transfer",
				"type": "event"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "owner",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					}
				],
				"name": "allowance",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "approve",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "account",
						"type": "address"
					}
				],
				"name": "balanceOf",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "decimals",
				"outputs": [
					{
						"internalType": "uint8",
						"name": "",
						"type": "uint8"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "subtractedValue",
						"type": "uint256"
					}
				],
				"name": "decreaseAllowance",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "spender",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "addedValue",
						"type": "uint256"
					}
				],
				"name": "increaseAllowance",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "name",
				"outputs": [
					{
						"internalType": "string",
						"name": "",
						"type": "string"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "symbol",
				"outputs": [
					{
						"internalType": "string",
						"name": "",
						"type": "string"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [],
				"name": "totalSupply",
				"outputs": [
					{
						"internalType": "uint256",
						"name": "",
						"type": "uint256"
					}
				],
				"stateMutability": "view",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "transfer",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			},
			{
				"inputs": [
					{
						"internalType": "address",
						"name": "from",
						"type": "address"
					},
					{
						"internalType": "address",
						"name": "to",
						"type": "address"
					},
					{
						"internalType": "uint256",
						"name": "amount",
						"type": "uint256"
					}
				],
				"name": "transferFrom",
				"outputs": [
					{
						"internalType": "bool",
						"name": "",
						"type": "bool"
					}
				],
				"stateMutability": "nonpayable",
				"type": "function"
			}
		];

	/*
	Deploying contracts with the account:
	0x7cEec4d52d270BC1c0dBF11D7e0174f762d489Ca
	RepairPotion deployed to:
	0xc62994C8A164C70899284E483Ba2443ef13F643D
	RewardPoolNFT deployed to:
	0x8946EE31706d064DEe3Ed3E3afd779B1b337E82A
	PaymentManager deployed to:
	0x4149D4cEFa409F18130C0640A5E82a75B78f68fD
	ClaimManager deployed to:
	0x6006313EcAD73d92C28e12549E5e98304Ef1d0E1
	Set claimManager in RewardPoolNFT
	Set claimManager in PaymentManager
	Set managerContract in RepairPotion
	Set fundRecipient in RepairPotion
	Set fundRecipient in RewardPoolNFT
	Minted 5 initial NFTs to owner
	MancalaGame deployed to:
	0xEF793f5400f2520e7be3A2C6e54e27f867a7F5DB
	Deployment script completed successfully
	*/
	// Contract addresses currently set to BNB testnet contracts for testing... (replace with actual addresses)
    const nftContractAddress = '0x8946EE31706d064DEe3Ed3E3afd779B1b337E82A';
    const claimManagerAddress = '0x6006313EcAD73d92C28e12549E5e98304Ef1d0E1';
    const paymentManagerAddress = '0x4149D4cEFa409F18130C0640A5E82a75B78f68fD';
    const potionContractAddress = '0xc62994C8A164C70899284E483Ba2443ef13F643D';

    document.addEventListener('DOMContentLoaded', async () => {
    let web3;
    let userAddress;

	let nftContract, claimManagerContract, paymentManagerContract, potionContract;

	let nftPurchaseAddress = '';
	let potionPurchaseTokenAddress = '';

  	const connectWalletButton = document.getElementById('connectWalletButton');
    connectWalletButton.addEventListener('click', async () => {
      await connectWallet();
    });

    async function connectWallet() {
      if (window.ethereum) {
        try {
          await window.ethereum.request({ method: 'eth_requestAccounts' });
          web3 = new Web3(window.ethereum);
          const accounts = await web3.eth.getAccounts();
          userAddress = accounts[0];
          connectWalletButton.textContent = `${userAddress.substring(0, 6)}...${userAddress.substring(userAddress.length - 4)}`;
          initializeContracts();
          refreshData();
        } catch (error) {
          console.error('User denied account access');
        }
      } else {
        alert('Please install MetaMask!');
      }
    }

    function initializeContracts() {
      nftContract = new web3.eth.Contract(nftAbi, nftContractAddress);
      claimManagerContract = new web3.eth.Contract(claimManagerAbi, claimManagerAddress);
      paymentManagerContract = new web3.eth.Contract(paymentManagerAbi, paymentManagerAddress);
      potionContract = new web3.eth.Contract(potionAbi, potionContractAddress);
    }

    async function refreshData() {
      await Promise.all([loadPaymentAddresses(), loadMintPrice(), loadPotionPrice(), loadPotionBalance(), loadUserNFTs(), loadClaimPeriodInfo(), loadSystemInfo()]);
    }

    async function loadMintPrice() {
      const mintPrice = await nftContract.methods.mintPrice().call();
	  // Get the mint token symbol
	  let mintTokenSymbol = "ETH"
	  const nftPurchaseAddress = await nftContract.methods.paymentToken().call();
	  if (nftPurchaseAddress != '0x0000000000000000000000000000000000000000') {
		const nftToken = await new web3.eth.Contract(erc20Abi, nftPurchaseAddress);
		mintTokenSymbol = await nftToken.methods.symbol().call();
	  }
      document.getElementById('mintPrice').textContent = web3.utils.fromWei(mintPrice, 'ether') + ' ' + mintTokenSymbol;
    }

	// This function and others still need to properly get the number of decimals if not ETH.
    async function loadPotionPrice() {
	  const potionPurchaseTokenAddress = await potionContract.methods.purchaseToken().call();
	  const potionPrice = await potionContract.methods.purchasePrice().call();
	  // Get the potion token symbol
	  let potionTokenSymbol = "ETH" 
	  if (potionPurchaseTokenAddress != '0x0000000000000000000000000000000000000000') {
		const potionToken = await new web3.eth.Contract(erc20Abi, potionPurchaseTokenAddress);
		potionTokenSymbol = await potionToken.methods.symbol().call();
	  }
      document.getElementById('potionPrice').textContent = web3.utils.fromWei(potionPrice, 'ether') + ' ' + potionTokenSymbol;
    }

    async function loadPotionBalance() {
      const balance = await potionContract.methods.balanceOf(userAddress).call();
      document.getElementById('potionBalance').textContent = balance.toString();
    }

	// Load payment token adresses
	async function loadPaymentAddresses() {
	  nftPurchaseAddress = await nftContract.methods.paymentToken().call();
	  potionPurchaseTokenAddress = await potionContract.methods.purchaseToken().call();
	}

    async function loadUserNFTs() {
      const nftGrid = document.getElementById('nftGrid');
      nftGrid.innerHTML = '';

      const balance = await nftContract.methods.balanceOf(userAddress).call();
      for (let i = 0; i < balance; i++) {
        const tokenId = await nftContract.methods.tokenOfOwnerByIndex(userAddress, i).call();
        const nftCard = await createNFTCard(tokenId);
        nftGrid.appendChild(nftCard);
      }
    }

    async function createNFTCard(tokenId) {
      const card = document.createElement('div');
      card.className = 'nft-card';

      const title = document.createElement('h3');
      title.textContent = `NFT #${tokenId}`;
      card.appendChild(title);

      const nftImage = document.createElement('div');
      nftImage.className = 'nft-image';
	  // Add image url for nft image
	  nftImage.style.backgroundImage = 'url("/media")';
      card.appendChild(nftImage);

      const health = await claimManagerContract.methods.getHealth(tokenId).call();
      const healthBarContainer = document.createElement('div');
      healthBarContainer.className = 'health-bar';
      const healthBar = document.createElement('div');
      healthBar.style.width = `${(Number(health) / 255) * 100}%`;
      healthBarContainer.appendChild(healthBar);
      card.appendChild(healthBarContainer);

      const healthInfo = document.createElement('div');
      healthInfo.textContent = `Health: ${health}/255`;
      card.appendChild(healthInfo);

      const totalClaims = await claimManagerContract.methods.getTotalClaims(tokenId).call();
      const claimsInfo = document.createElement('div');
      claimsInfo.textContent = `Total Claims: ${totalClaims}`;
      card.appendChild(claimsInfo);

      const hasClaimed = await claimManagerContract.methods.hasClaimedInPeriod(tokenId).call();
      const claimStatus = document.createElement('div');
      claimStatus.textContent = `Has Claimed: ${hasClaimed ? 'Yes' : 'No'}`;
      card.appendChild(claimStatus);

      const actionButtons = document.createElement('div');
      actionButtons.className = 'action-buttons';

      const claimButton = document.createElement('button');
      claimButton.className = 'button';
      claimButton.textContent = 'Request Claim';
      claimButton.disabled = hasClaimed || health < (await claimManagerContract.methods.min_health().call());
      claimButton.addEventListener('click', async () => {
        await claimReward(tokenId);
      });
      actionButtons.appendChild(claimButton);

      const repairButton = document.createElement('button');
      repairButton.className = 'button';
      repairButton.textContent = 'Repair NFT';
      const potionBalance = await potionContract.methods.balanceOf(userAddress).call();
      repairButton.disabled = health >= 255 || potionBalance == 0;
      repairButton.addEventListener('click', async () => {
        await repairNFT(tokenId);
      });
      actionButtons.appendChild(repairButton);

      card.appendChild(actionButtons);
      return card;
    }

    async function claimReward(tokenId) {
      try {
        const tx = await claimManagerContract.methods.claim(tokenId).send({ from: userAddress });
        showNotification('Reward claimed successfully!');
        refreshData();
      } catch (error) {
        console.error(error);
        showNotification('Failed to claim reward.', true);
      }
    }

    async function repairNFT(tokenId) {
      try {
		// Check approval for token and approve if needed
		const allowance = await potionContract.methods.allowance(userAddress, potionContractAddress).call();
		if (allowance == 0) {
			await potionContract.methods.approve(potionContractAddress, 1).send({ from: userAddress });
		}
        const tx = await claimManagerContract.methods.repair(tokenId, 1).send({ from: userAddress });
        showNotification('NFT repaired successfully!');
        refreshData();
      } catch (error) {
        console.error(error);
        showNotification('Failed to repair NFT.', true);
      }
    }

    const mintButton = document.getElementById('mintButton');
    mintButton.addEventListener('click', async () => {
      await mintNFT();
    });

    async function mintNFT() {
      try {
        const mintPrice = Number(await nftContract.methods.mintPrice().call());
		let mintAmt = document.getElementById('mintAmt').value;
		let totalPrice = mintPrice * mintAmt;
		// Send eth if the nft purchase address is address 0. Otherwise send the token
		if (nftPurchaseAddress == '0x0000000000000000000000000000000000000000') {
			const tx = await nftContract.methods.mint(mintAmt).send({ from: userAddress, value: totalPrice });
		} else {
			const tokenContract = new web3.eth.Contract(erc20Abi, nftPurchaseAddress);
			const allowance = await tokenContract.methods.allowance(userAddress, nftContractAddress).call();
			if (allowance < totalPrice) {
				await tokenContract.methods.approve(nftContractAddress, totalPrice).send({ from: userAddress });
			}
			const tx = await nftContract.methods.mint(mintAmt).send({ from: userAddress });
		}

        showNotification('NFTs minted successfully!');
        refreshData();
      } catch (error) {
        console.error(error);
        showNotification('Failed to mint NFT.', true);
      }
    }

    const buyPotionButton = document.getElementById('buyPotionButton');
    buyPotionButton.addEventListener('click', async () => {
      const amount = document.getElementById('potionAmount').value;
      if (amount > 0) {
        await buyPotions(amount);
      } else {
        alert('Please enter a valid amount.');
      }
    });

    async function buyPotions(amount) {
      try {
        const potionPrice = await potionContract.methods.purchasePrice().call();
        const totalCost = web3.utils.toWei(potionPrice, 'ether') * amount;
		// Send eth if the potion purchase token address is address 0. Otherwise send the token
		if (potionPurchaseTokenAddress == '0x0000000000000000000000000000000000000000') {
			const tx = await potionContract.methods.buy(amount).send({ from: userAddress, value: totalCost });
		} else {
			const tokenContract = new web3.eth.Contract(erc20Abi, potionPurchaseTokenAddress);
			const allowance = await tokenContract.methods.allowance(userAddress, potionContractAddress).call();
			if (allowance < totalCost) {
				await tokenContract.methods.approve(potionContractAddress, totalCost).send({ from: userAddress });
			}
			const tx = await potionContract.methods.buy(amount).send({ from: userAddress });
		}

        showNotification('Potions purchased successfully!');
        refreshData();
      } catch (error) {
        console.error(error);
        showNotification('Failed to buy potions.', true);
      }
    }

    async function loadClaimPeriodInfo() {
      const timeRemainingElement = document.getElementById('timeRemaining');
      const claimantsCountElement = document.getElementById('claimantsCount');
      const claimerLimitElement = document.getElementById('claimerLimit');

      const claimPeriod = await claimManagerContract.methods.claimPeriod().call();
      const lastClaimTime = await paymentManagerContract.methods.lastClaimTime().call();
      const currentTime = Math.floor(Date.now() / 1000);
      const timeRemaining = parseInt(lastClaimTime) + parseInt(claimPeriod) - currentTime;

      timeRemainingElement.textContent = timeRemaining > 0 ? `${timeRemaining} seconds` : 'Period Ended';

      const claimantsCount = await claimManagerContract.methods.getClaimantsCount().call();
      const claimerLimit = await claimManagerContract.methods.claimerLimit().call();
      claimantsCountElement.textContent = claimantsCount.toString();
      claimerLimitElement.textContent = claimerLimit.toString();
    }

    async function loadSystemInfo() {
      const rewardRateElement = document.getElementById('rewardRate');
      const specialRewardRateElement = document.getElementById('specialRewardRate');
      const minClaimsElement = document.getElementById('minClaims');
      const totalNftsElement = document.getElementById('totalNfts');

      const rewardRate = await paymentManagerContract.methods.rewardRate().call();
      const specialRewardRate = await paymentManagerContract.methods.specialRewardRate().call();
      const minClaims = await paymentManagerContract.methods.min_claims().call();
      const totalNfts = await nftContract.methods.totalSupply().call();
	  const payoutToken = await paymentManagerContract.methods.rewardToken().call();

	  let tokenName = "ETH";

	  // Use the reward token address to get the token name if not ETH
	  if (payoutToken != '0x0000000000000000000000000000000000000000') {
		  let tokenContract = new web3.eth.Contract(erc20Abi, payoutToken);
		  tokenName = await tokenContract.methods.name().call();
	  }
      rewardRateElement.textContent = web3.utils.fromWei(rewardRate, 'ether') + ' ' + tokenName;
      specialRewardRateElement.textContent = web3.utils.fromWei(specialRewardRate, 'ether') + ' ' + tokenName;
      minClaimsElement.textContent = minClaims.toString();
      totalNftsElement.textContent = totalNfts.toString();
    }

    function showNotification(message, isError = false) {
      const notificationArea = document.getElementById('notificationArea');
      const notification = document.createElement('div');
      notification.className = 'notification';
      if (isError) {
        notification.classList.add('error-notification');
      }
      notification.textContent = message;
      notificationArea.appendChild(notification);
      setTimeout(() => {
        notificationArea.removeChild(notification);
      }, 4000);
    }

	// Refresh data every 10 seconds
    setInterval(refreshData, 10000);

    if (window.ethereum) {
      web3 = new Web3(window.ethereum);
      web3.eth.getAccounts().then(accounts => {
        if (accounts.length > 0) {
          userAddress = accounts[0];
          connectWalletButton.textContent = `${userAddress.substring(0, 6)}...${userAddress.substring(userAddress.length - 4)}`;
          initializeContracts();
	      refreshData();
		
        }
      });
    }
  });
  </script>
</body>
</html>
